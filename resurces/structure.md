
Этот проект реализует систему экспорта данных об обученных лицах из CRM в XML-формат, соответствующий схеме `educated_person_import_v1.0.8.xsd`.

## Структура проекта

```
├── examples/                      # Примеры и демонстрации
│   ├── export_demo.php            # Демо-скрипт для проверки экспорта
│   ├── run_export_test.php        # Запуск тестирования экспорта
│   └── output/                    # Директория для выходных файлов
│
├── resources/                     # Ресурсы проекта
│   └── educated_person_import_v1.0.8.xsd  # XSD-схема для валидации
│
├── src/                           # Исходный код
│   ├── Controller/                # Контроллеры
│   │   └── ExportController.php   # Контроллер для экспорта
│   │
│   ├── DTO/                       # Data Transfer Objects
│   │   └── StudentExportData.php  # DTO для данных студента
│   │
│   ├── Exception/                 # Исключения
│   │   └── XmlValidationException.php  # Ошибки валидации XML
│   │
│   ├── Factory/                   # Фабрики
│   │   └── XmlDocumentFactory.php # Создание XML-документов
│   │
│   ├── Model/                     # Модели данных
│   │   ├── Group.php              # Модель группы
│   │   ├── Organization.php       # Модель организации
│   │   └── Student.php            # Модель студента
│   │
│   └── Service/                   # Сервисы
│       ├── DataCollector/         # Сборщики данных
│       │   ├── DataCollectorInterface.php  # Интерфейс сборщика данных
│       │   └── StudentDataCollector.php    # Сборщик данных студентов
│       │
│       ├── EducatedPersonExporter.php  # Основной сервис экспорта
│       └── Validator/             # Валидаторы
│           └── XmlValidator.php   # Валидатор XML
│
└── vendor/                        # Зависимости (будет создано автоматически)
```

## Требования

- PHP 8.1 или выше
- Расширение DOM для работы с XML
- Расширение libxml для валидации XML

## Проверка работоспособности

Для демонстрации работы системы выполните:

```bash
php examples/run_export_test.php
```

Этот скрипт создаст необходимые директории, сгенерирует тестовые данные и продемонстрирует работу различных методов экспорта:
1. Экспорт всех студентов
2. Экспорт студентов конкретной группы
3. Экспорт одного студента

Результаты будут сохранены в директории `examples/output/`.

## Основные компоненты

### DTO
- `StudentExportData` - иммутабельный объект для хранения данных студента для экспорта

### Фабрики
- `XmlDocumentFactory` - создает XML-документы в соответствии с XSD-схемой

### Сервисы
- `EducatedPersonExporter` - основной сервис для экспорта данных
- `StudentDataCollector` - собирает данные о студентах из разных источников
- `XmlValidator` - проверяет соответствие XML схеме XSD

### Контроллеры
- `ExportController` - обрабатывает запросы на экспорт и возвращает результаты

## Дальнейшее развитие

Планы по улучшению системы подробно описаны в документах:
- `src/llm-features-request.md` - исходные требования
- `src/llm-features-request-v2.md` - расширенные возможности и улучшения
